<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Demo</title>
		<link rel="stylesheet" href="demo.css" />
	</head>
	<body>
			<ul id="ul">
				<li class="liBox">
					<div>
						<div class="lid011" id="checkAll" ><h5>全选</h5></div>
					</div>	
					<input type="button" value="全部删除" onclick="delall()" class="del"/>
				</li>
				<li class="liBox11">
					<div class="checkbox">
						<input type="checkbox" name="chebox" id="checkbox001">
					</div>
					<div class="lid010"><h5>编号</h5></div>
					<div class="lid010"><h5>姓名</h5></div>
					<div class="lid010"><h5>密码</h5></div>
					<div class="lid010"><h5>生日</h5></div>
					<div class="lid010"><h5>地址</h5></div>
					<div class="lid00000"><h5>操作</h5></div>
				</li>
			</ul>
		<form action="">
		<!--第二张表-->	
			<ul>
				<li class="liBox00">
					<div class="title">
						<div>
							<h2>数据查询</h2>
						</div>
						<div>
							<input type="search" id="search" placeholder="请输入需要查找的数据编号" onclick="removeli()"/><button type="button" class="search" onclick="searchbtn()">搜索</button>
							<ul id=list>
								<li class="liBox111">
									<div class="checkbox">
										<input type="checkbox" name="chebox" id="checkbox001">
									</div>
									<div class="lid010"><h5>编号</h5></div>
									<div class="lid010"><h5>姓名</h5></div>
									<div class="lid010"><h5>密码</h5></div>
									<div class="lid010"><h5>生日</h5></div>
									<div class="lid010"><h5>地址</h5></div>
									<div class="lid00000"><h5>操作</h5></div>
								</li>
							</ul>
						</div>
						
					</div>	
				</li>
				
					<div class="title1">
						<h2>新增数据</h2>
					</div>
				<li class="liBox0000">
					<div class="lid0"><h5>编号</h5></div>
					<div class="lid01">
						<input id="d1" type="text"/>
					</div>
				</li>
				<li class="liBox0000">
					<div class="lid0"><h5>姓名</h5></div>
					<div class="lid01">
						<input  id="d2" type="text" />
					</div>
				</li>
				<li class="liBox0000">
					<div class="lid0"><h5>密码</h5></div>
					<div class="lid01">
						<input  id="d3" type="password" />
					</div>
				</li>
				<li class="liBox0000">
					<div class="lid0"><h5>生日</h5></div>
					<div class="lid01">
						<input id="d4" type="text" />
					</div>
				</li>
				<li class="liBox0000">
					<div class="lid0"><h5>地址</h5></div>
					<div class="lid01">
						<input  id="d5" type="text" />
					</div>
				</li>
				<li class="liBox0001">	
					<button type="reset" value="Reset" class="del3">重置</button>
					<button type="button" class="del4">添加</button>
					<button type="button" class="del5" onclick="update(this)">更新</button>
				</li>
			</ul>
		</form>
	</body>
	<script type="">
			var userArr = [];//创建一个空数组，用来保存添加的数据
			/*全部删除按钮*/
			function delall(){
				var ul = document.getElementById("ul");//整个表
				var chebox=document.getElementsByName("chebox");//复选框
				//console.log(chebox);
				/*遍历所有复选框*/
				for(var i=1;i<chebox.length;i++){
					if(chebox[i].checked){//如果被选中
						var cheboxs = chebox[i].parentNode.parentNode;//获取被选中复选框的li
						ul.removeChild(cheboxs);
						i--;//全选删除
					}
				}
				/*清空新增数据文本框*/
				document.getElementById("d1").value="";
				document.getElementById("d2").value="";
				document.getElementById("d3").value="";
				document.getElementById("d4").value="";
				document.getElementById("d5").value="";
				/*初始化复选框状态*/
				document.getElementsByName("chebox").checked=false;
			}

			/*复选框功能*/
			/*全选*/
			var checkAll = document.getElementById("checkbox001");
				checkAll.addEventListener("click", ckAll);
			function ckAll(){
				var checkAll=document.getElementById("checkbox001").checked;
				var checks=document.getElementsByName("chebox");
				for(var i=0;i<checks.length;i++){
					checks[i].checked=checkAll;
				}
			}
			
			/*单元格删除按钮*/
			function removeElement(e){				
				var ul = document.getElementById("ul");//获取整个动态添加li的ul
				ul.removeChild(e.parentNode.parentNode);//移除当前按钮父元素的父元素
			}	
			/*添加按钮*/
				var btn = document.getElementsByClassName("del4");//获取添加按钮
				btn[0].addEventListener("click", addElement);//为添加按钮增加监听事件
			

			/*添加按钮*/
			function addElement(){
				/*获取input内容*/
				var add=document.getElementById("d1").value;
				var add1=document.getElementById("d2").value;
				var add2=document.getElementById("d3").value;
				var add3=document.getElementById("d4").value;
				var add4=document.getElementById("d5").value;			
				/*如果输入为空，禁用添加按钮*/
				if(add==''||add1==''||add2==''||add3==''||add4==''){
					console.log("请填写您的完整信息！");
				}else{
					/*动态创建li添加到ul*/
			　　　　var ul = document.getElementById("ul");//创建一个li
			　　　　var li = document.createElement("LI");	
			　　　　li.setAttribute("class", "liBox11");//设置 li 属性
					li.innerHTML = "<div class='checkbox'><input type='checkbox' name='chebox' ></div><div class='lid00'>"+add+"</div><div class='lid00'>"+add1+"</div><div class='lid00'>"+add2+"</div><div class='lid00'>"+add3+"</div><div class='lid000'>"+add4+"</div><div class='lid0000'><button class='del0' id='ddd' onclick='removeElement(this)'>删除</button></div><div ><button class='del1'onclick='modify(this)'>修改</button></div>"
			　　　   ul.appendChild(li);
					/*添加之后清空input值*/
					document.getElementById("d1").value="";
					document.getElementById("d2").value="";
					document.getElementById("d3").value="";
					document.getElementById("d4").value="";
					document.getElementById("d5").value="";	
				
					/*添加数据内容存储在localStorage*/
					userArr.push([add,add1,add2,add3,add4]);//将获取的iniput的值存入一个二维数组中
					localStorage.setItem('userArr',JSON.stringify(userArr));//转为字符串形式存入localStorage中
				
				}
　　			}	



			/*搜索框----根据编号查找localStorage存储的数据*/
			var timer = 0;
			var search_input = document.getElementById('search');//获取搜索框
			search_input.addEventListener('keyup',function(e){//增加一个监听事件（键盘抬起事件）
				var value = search_input.value;//获取搜索框中的内容
				timer = setTimeout(function(){//设置一个定时器
					clearTimeout(timer);//清空定时器
					var search_result = [];//创建一个新数组
					var userArr = localStorage.getItem('userArr');//将存储在localStorage中的字符串类型数值取出
					userArr = JSON.parse(userArr);//转为JSON对象（一个二维数组）
					//console.log(userArr)//打印全部localStorage对象
					for(var i = 0;i<userArr.length;i++){//遍历这个二维数组
						if(userArr[i][0].indexOf(value.trim()) != -1){//如果在这个数组的编号部分，检索字符串值出现（获取的搜索框中的内容去除空格（trim()）！=-1）
							search_result.push(userArr[i]);//就将此条数据push入新数组
						}
					}
					console.log((search_result));//将数组数据打印在控制台上
				},100)
			})
			/*搜索按钮*/
			var search_btn=document.getElementsByClassName("search");
			var search_input = document.getElementById('search');
			function searchbtn(){
					var value = search_input.value;
					var search_result = [];//创建一个新数组
					var userArr = localStorage.getItem('userArr');//将存储在localStorage中的字符串类型数值取出
					userArr = JSON.parse(userArr);//转为JSON对象（一个二维数组）
					//console.log(userArr)//打印全部localStorage对象
					for(var i = 0;i<userArr.length;i++){//遍历这个二维数组
						if(userArr[i][0].indexOf(value.trim()) != -1){//如果在这个数组的编号部分，检索字符串值出现（获取的搜索框中的内容去除空格（trim()）！=-1）
							search_result.push(userArr[i]);//就将此条数据push入新数组
						}
					}
					console.log(value--);
					console.log(userArr[value--]);
					console.log(userArr.length);
					
					if(true){
						var list = document.getElementById('list');
						var li = document.createElement("LI");
						li.setAttribute("class", "liBox1");
//						li.innerHTML = "&nbsp&nbsp"+search_result[0][1];
						li.innerHTML ="<div class='checkbox'><input type='checkbox' name='chebox' ></div><div class='lid00'>"+search_result[0][0]+"</div><div class='lid00'>"+search_result[0][1]+"</div><div class='lid00'>"+search_result[0][2]+"</div><div class='lid00'>"+search_result[0][3]+"</div><div class='lid000'>"+search_result[0][4]+"</div><div class='lid0000' ><button style='background-color:#B0C4DE;' class='del0' id='ddd' onclick='#' disabled='disabled' >删除</button></div><div ><button class='del1'onclick='#' disabled='disabled' style='background-color:#B0C4DE;'>修改</button></div>"
						list.appendChild(li);
					}
					
			}
			/*搜索清空*/
			function removeli(){
				var li = document.getElementsByClassName("liBox1");
				var ul = document.getElementById("list");
				ul.removeChild(li[0]);
				document.getElementById('search').value='';
			}
			
						
			/*修改按钮*/
			function modify(e){
				var d1=document.getElementById("d1");
				var d2=document.getElementById("d2");
				var d3=document.getElementById("d3");
				var d4=document.getElementById("d4");
				var d5=document.getElementById("d5");				
				d1.value = e.parentNode.parentNode.children[1].innerHTML;
				d2.value = e.parentNode.parentNode.children[2].innerHTML;
				d3.value = e.parentNode.parentNode.children[3].innerHTML;
				d4.value = e.parentNode.parentNode.children[4].innerHTML;
				d5.value = e.parentNode.parentNode.children[5].innerHTML;
				/*获取点击记录行*/
				that = e.parentNode.parentNode;
			}
			
			/*更新按钮*/
			function update(e){
				/*重新获取修改后input内容*/
				var add=document.getElementById("d1").value;
				var add1=document.getElementById("d2").value;
				var add2=document.getElementById("d3").value;
				var add3=document.getElementById("d4").value;
				var add4=document.getElementById("d5").value;
				/*数据更新到原有的li上替换原来的数据*/				
				that.children[1].innerHTML =add;//记录行的第一个子元素内容修改
				that.children[2].innerHTML =add1;//记录行的第二个子元素内容修改
				that.children[3].innerHTML =add2;//记录行的第三个子元素内容修改
				that.children[4].innerHTML =add3;//记录行的第四个子元素内容修改
				that.children[5].innerHTML =add4;//记录行的第五个子元素内容修改
				/*更新之后清空input值*/
				document.getElementById("d1").value="";
				document.getElementById("d2").value="";
				document.getElementById("d3").value="";
				document.getElementById("d4").value="";
				document.getElementById("d5").value="";
			}
					
 
	</script>
</html>
